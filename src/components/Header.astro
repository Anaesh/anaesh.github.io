<!-- src/components/Header.astro -->

---
import NavbarIcon from './NavbarIcon.astro'; // Adjust path if needed
---

<nav id="navbar" class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#home">
      <span class="text-accent">A</span>naesh K N
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <NavbarIcon /> <!-- Use the component -->
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
        <li class="nav-item"><a class="nav-link" href="#skills">Skills</a></li>
        <li class="nav-item"><a class="nav-link" href="#experience">Experience</a></li>
        <li class="nav-item"><a class="nav-link" href="#education">Education</a></li>
        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
        <!-- Theme Toggle Button for Mobile -->
        <li class="nav-item">
          <button id="theme-toggle-mobile" class="btn theme-toggle-desktop nav-link w-100 text-start" aria-label="Toggle theme">
            <i class="bi bi-moon-fill theme-icon-dark"></i>
            <i class="bi bi-sun-fill theme-icon-light"></i>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section');

    window.addEventListener('scroll', () => {
      let current = '';

      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (window.scrollY >= sectionTop - sectionHeight / 4 && window.scrollY < sectionTop + sectionHeight) {
          current = section.getAttribute('id');
        }
      });

      if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
        current = 'contact';
      }

      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').includes(current)) {
          link.classList.add('active');
        }
      });
    });
  });
</script>